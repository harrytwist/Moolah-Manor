<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Moolah Manor 🎰</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #1a1a1a;
      color: #fff;
      padding: 20px;
    }
    h1 { color: #ffcc00; }
    #balance { font-weight: bold; }
    #reels {
      display: flex;
      justify-content: center;
      margin: 20px 0;
    }
    .reel {
      display: flex;
      flex-direction: column;
      margin: 0 5px;
      border: 2px solid #444;
      padding: 5px;
      background: #222;
      border-radius: 8px;
    }
    .symbol {
      font-size: 2.5rem;
      margin: 5px 0;
    }
    button {
      padding: 10px 20px;
      font-size: 1.2rem;
      border-radius: 10px;
      border: none;
      background: #ffcc00;
      color: #000;
      cursor: pointer;
    }
    button:hover { background: #ffaa00; }
    #log {
      margin-top: 20px;
      max-height: 300px;
      overflow-y: auto;
      background: #222;
      padding: 10px;
      border-radius: 10px;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <h1>Moolah Manor 🎃</h1>
  <div>Balance: <span id="balance">100</span> credits</div>
  <div id="reels"></div>
  <button onclick="spin()">Spin (Bet 5)</button>
  <div id="log"></div>

<script>
// -----------------------------
// Moolah Manor 5x3 Slot
// -----------------------------

let balance = 100;
let bet = 5;
let freeSpins = 0;

// Symbols
const symbols = ["J","Q","K","💰","🏰","👻","🧟"]; // low, mid, bonus

// Paytable for base game (3+ in a row, left to right)
const paytable = {
  "J": [0,0,2,5,10],
  "Q": [0,0,2,5,10],
  "K": [0,0,2,5,10],
  "💰": [0,0,10,25,50],
  "🏰": [0,0,10,25,50],
  "👻": [0,0,10,25,50]
};

// Generate a single reel (array of 3 symbols)
function spinReel() {
  let reel = [];
  for (let i=0; i<3; i++) {
    reel.push(symbols[Math.floor(Math.random()*symbols.length)]);
  }
  return reel;
}

// Spin all reels
function spinReels() {
  let reels = [];
  for (let i=0; i<5; i++) {
    reels.push(spinReel());
  }
  return reels;
}

// Display reels
function renderReels(reels) {
  const reelsDiv = document.getElementById("reels");
  reelsDiv.innerHTML = '';
  for (let col=0; col<5; col++) {
    const reelDiv = document.createElement("div");
    reelDiv.className = "reel";
    reels[col].forEach(symbol=>{
      const symDiv = document.createElement("div");
      symDiv.className = "symbol";
      symDiv.textContent = symbol;
      reelDiv.appendChild(symDiv);
    });
    reelsDiv.appendChild(reelDiv);
  }
}

// Calculate payout (middle row only for simplicity)
function calculatePayout(reels, bet, isFree=false) {
  let middleRow = reels.map(reel => reel[1]); // middle symbols
  let first = middleRow[0];
  let count = 1;
  for (let i=1; i<5; i++) {
    if (middleRow[i] === first && paytable[first]) count++;
    else break;
  }
  let payout = (paytable[first] && count >=3) ? paytable[first][count-1] * bet : 0;
  if (isFree && payout>0) payout *=2; // 2x multiplier in free spins
  return payout;
}

// Count monsters anywhere
function countMonsters(reels) {
  let total = 0;
  reels.forEach(reel => {
    reel.forEach(sym => { if (sym==="🧟") total++; });
  });
  return total;
}

// Logging helper
function log(msg) {
  const logBox = document.getElementById("log");
  logBox.innerHTML = msg + "<br>" + logBox.innerHTML;
}

// Play one spin
function playSpin(isFree=false) {
  if (!isFree) balance -= bet;
  const reels = spinReels();
  renderReels(reels);
  const payout = calculatePayout(reels, bet, isFree);
  balance += payout;
  const monsters = countMonsters(reels);

  log(`${isFree ? "(Free Spin)" : "(Base Spin)"} ${reels.map(r=>r[1]).join(" | ")} ➜ Won ${payout}`);

  if (monsters>=3) {
    freeSpins += 10;
    log("🎉 Bonus Triggered! +10 Free Spins!");
  }
}

// Spin button handler
function spin() {
  if (freeSpins>0) {
    freeSpins--;
    playSpin(true);
  } else {
    if (balance<bet) { log("Not enough balance!"); return; }
    playSpin(false);
  }
  document.getElementById("balance").innerText = balance;
}

// Initial render
renderReels([spinReel(), spinReel(), spinReel(), spinReel(), spinReel()]);
</script>
</body>
</html>
